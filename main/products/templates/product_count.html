{% load humanize %}
<small class="fsz-12 color-666 text-uppercase mb-2">قیمت کل:</small>

{% if variant.price %}
    <h4 class="fw-bold mb-0 text-primary" style="font-family: 'Yekan', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-weight: 600; letter-spacing: -0.5px;">
        <span class="persian-number" style="font-family: 'Dana', 'Yekan', sans-serif; font-weight: 500; color: #4a4a4a;">{{ variant.price|intcomma }}</span>
        <small class="fs-6" style="font-weight: 400;">تومان</small>
    </h4>
    
    {% if variant.stock > 0 %}
        <p class="fsz-12 mt-3">
            <i class="fas fa-check-circle color-green2 me-1"></i>در انبار
        </p>
    {% else %}
        <p class="fsz-12 mt-3 text-danger">
            <i class="fas fa-times-circle me-1"></i>موجود نیست
        </p>
    {% endif %}
{% else %}
    <h5 class="fsz-30 fw-bold text-danger">ناموجود</h5>
    
    <p class="fsz-12 mt-3 text-danger">
        <i class="fas fa-times-circle me-1"></i> لطفا گزینه های دیگر رو بررسی کنید
    </p>
{% endif %}

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} fsz-12 mt-2">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

{% if variant.price and variant.stock > 0 %}  
    {% if quantity > 0 %}
        
        <div class="quantity-control d-flex justify-content-center align-items-center mt-4">
            <button class="btn-quantity minus rounded-start" 
                    hx-post="{% url 'carts:cart_decrease' %}"
                    hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                    hx-vals='{"variant":{{ variant.id }}, "product_id": {{product.id}}}'
                    hx-target="#product-list">
                <i class="{% if quantity == 1 %}fas fa-trash-alt{% else %}fas fa-minus{% endif %}"></i>
            </button>

            <input class="quantity-input text-center" 
                   type="text" 
                   value="{{quantity}}"
                   readonly />

            <button class="btn-quantity plus rounded-end {% if quantity >= variant.stock %}disabled{% endif %}"
                    hx-post="{% url 'carts:cartadd' %}"
                    hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
                    hx-vals='{"variant":{{ variant.id }}, "product_id": {{product.id}}}'
                    hx-target="#product-list"
                    {% if quantity >= variant.stock %}disabled{% endif %}>
                <i class="fas fa-plus"></i>
            </button>
        </div>
        
        {% if quantity >= variant.stock %}
            <p class="fsz-12 text-danger mt-2">
                <i class="fas fa-exclamation-circle me-1"></i>
                حداکثر تعداد قابل خرید: {{ variant.stock }}
            </p>
        {% endif %}
    {% else %}
<div class="text-center mt-3">
    <button type="button"
            class="butn btn-loading bg-green2 text-white radius-4 fw-500 fsz-12 text-uppercase py-2 px-4 w-100"
            style="border: none; cursor: pointer;"
            hx-post="{% url 'carts:cartadd' %}"
            hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
            hx-vals='{"variant":{{ variant.id }}, "product_id": {{product.id}}}'
            hx-target="#product-list">
        <span class="btn-text">به سبد خرید اضافه کنید</span>
    </button>
</div>
    {% endif %}
{% endif %}


